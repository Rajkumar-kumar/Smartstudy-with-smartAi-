<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Master Admin Panel</title>
    <style>
        :root { --bg: #1e293b; --card: #334155; --text: #f8fafc; --accent: #3b82f6; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; }
        
        /* Sidebar */
        .sidebar { width: 250px; background: #0f172a; padding: 20px; border-right: 1px solid #334155; }
        .logo { font-size: 20px; font-weight: bold; color: var(--accent); margin-bottom: 30px; }
        .nav-item { padding: 12px; cursor: pointer; border-radius: 6px; margin-bottom: 5px; }
        .nav-item:hover, .nav-item.active { background: var(--accent); }

        /* Main */
        .main { flex: 1; padding: 30px; overflow-y: auto; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--card); padding: 20px; border-radius: 10px; }
        .stat-card h3 { margin: 0; font-size: 14px; opacity: 0.7; }
        .stat-card p { margin: 5px 0 0; font-size: 28px; font-weight: bold; }

        /* Tables & Forms */
        .box { background: var(--card); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #475569; }
        th { color: #94a3b8; font-size: 12px; text-transform: uppercase; }
        
        input, select { background: #1e293b; border: 1px solid #475569; color: white; padding: 10px; width: 100%; border-radius: 5px; margin-top: 5px; box-sizing: border-box; }
        button { background: var(--accent); color: white; border: none; padding: 10px 20px; width: 100%; border-radius: 5px; margin-top: 15px; cursor: pointer; }
        button:hover { opacity: 0.9; }

        .live-indicator { color: #22c55e; font-size: 12px; font-weight: bold; animation: blink 2s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="logo">üöÄ Smart Admin</div>
        <div class="nav-item active">Dashboard</div>
        <div class="nav-item">Course Manager</div>
        <div class="nav-item">Student Data</div>
    </div>

    <div class="main">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>Dashboard</h2>
            <span class="live-indicator">‚óè SYSTEM LIVE</span>
        </div>

        <div class="grid">
            <div class="stat-card">
                <h3>TOTAL STUDENTS</h3>
                <p id="totalStudents">0</p>
            </div>
            <div class="stat-card">
                <h3>ACTIVE COURSES</h3>
                <p id="totalCourses">0</p>
            </div>
            <div class="stat-card">
                <h3>REVENUE</h3>
                <p>‚Çπ 0.00</p>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
            
            <div class="box">
                <h3>üë• Recent Student Logins (Real-Time)</h3>
                <table id="loginTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Mobile Number</th>
                            <th>Time</th>
                        </tr>
                    </thead>
                    <tbody id="loginList">
                        </tbody>
                </table>
            </div>

            <div class="box">
                <h3>‚ûï Upload Content</h3>
                <label>Topic Name</label>
                <input type="text" id="topicInput" placeholder="Ex: Percentage Class 1">
                
                <label style="margin-top:10px; display:block;">Access Type</label>
                <select id="typeInput">
                    <option value="free">‚úÖ Free Class</option>
                    <option value="locked">üîí Paid (Locked)</option>
                </select>

                <button onclick="publishContent()">Publish to App</button>
            </div>

        </div>

        <div class="box">
            <h3>üìö Your Live Courses</h3>
            <div id="adminCourseList"></div>
        </div>
    </div>

    <script>
        // 1. REFRESH DATA (Reads what students are doing)
        function refreshData() {
            // Get Students
            const students = JSON.parse(localStorage.getItem('allStudents')) || [];
            document.getElementById('totalStudents').innerText = students.length;

            const loginList = document.getElementById('loginList');
            loginList.innerHTML = '';
            
            // Show last 5 logins
            students.slice().reverse().slice(0, 5).forEach(std => {
                loginList.innerHTML += `
                    <tr>
                        <td style="font-weight:bold;">${std.name}</td>
                        <td style="font-family:monospace; color:#60a5fa;">${std.phone}</td>
                        <td style="color:#94a3b8; font-size:12px;">${std.time}</td>
                    </tr>
                `;
            });

            // Get Courses
            const courses = JSON.parse(localStorage.getItem('appCourses')) || [];
            document.getElementById('totalCourses').innerText = courses.length;
            
            const courseList = document.getElementById('adminCourseList');
            courseList.innerHTML = '';
            courses.forEach((c, index) => {
                courseList.innerHTML += `
                    <div style="padding:10px; border-bottom:1px solid #444; display:flex; justify-content:space-between;">
                        <span>${c.name} <b style="font-size:10px; background:${c.type=='locked'?'red':'green'}; padding:2px 5px; border-radius:3px;">${c.type.toUpperCase()}</b></span>
                        <button style="width:auto; padding:5px; margin:0; background:#ef4444; font-size:10px;" onclick="deleteCourse(${index})">Remove</button>
                    </div>`;
            });
        }

        // 2. PUBLISH CONTENT
        function publishContent() {
            const name = document.getElementById('topicInput').value;
            const type = document.getElementById('typeInput').value;
            
            if(!name) return alert("Please enter a topic name");

            const courses = JSON.parse(localStorage.getItem('appCourses')) || [];
            courses.push({ name, type, date: new Date().toLocaleTimeString() });
            
            localStorage.setItem('appCourses', JSON.stringify(courses));
            
            document.getElementById('topicInput').value = '';
            refreshData();
            alert("Course Published! Student can see it now.");
        }

        // 3. DELETE COURSE
        function deleteCourse(index) {
            const courses = JSON.parse(localStorage.getItem('appCourses')) || [];
            courses.splice(index, 1);
            localStorage.setItem('appCourses', JSON.stringify(courses));
            refreshData();
        }

        // Auto-Refresh every 2 seconds (To see new logins instantly)
        setInterval(refreshData, 2000);
        refreshData();
    </script>
</body>
</html>
